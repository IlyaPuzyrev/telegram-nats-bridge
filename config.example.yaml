# Example configuration file for telegram-nats-bridge

# Mode: "first" - send to first matched route's subject
#        "all"  - send to all matched routes' subjects
mode: "first"

# Number of concurrent workers for route processing (default: 5)
route_workers: 5

# Number of concurrent workers for publishing to NATS (default: 5)
publish_workers: 5

# Timeout in seconds for graceful shutdown of publisher (default: 10)
publish_shutdown_timeout: 10

# Routes for message routing
# Each route has:
#   condition: expr condition (returns bool)
#   subject: destination subject
#     type: "string" (static) or "expr" (dynamic)
#     value: subject string or expr program
routes:
  # Messages from specific user by ID (dynamic subject)
  - condition: "update.message?.from?.id != nil"
    subject:
      type: "expr"
      value: "sprintf(\"telegram.messages.%v\", update.message.from.id)"

  # Edited messages
  - condition: "update.edited_message != nil"
    subject:
      type: "string"
      value: "telegram.edited"

  # Callback queries
  - condition: "update.callback_query != nil"
    subject:
      type: "string"
      value: "telegram.callbacks"

  # All messages (catch-all)
  # - condition: "update.message != nil"
  #   subject:
  #     type: "string"
  #     value: "telegram.messages"

# Optional: Telegram bot token (can also be set via TELEGRAM_BOT_TOKEN env)
# telegram_token: "your-bot-token"

# Optional: NATS server URL (can also be set via NATS_URL env)
# nats_url: "nats://localhost:4222"
